<!doctype html><html lang=en dir=auto data-theme=auto><head><script src="/wuulong-notes-blog/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=wuulong-notes-blog/livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>【實戰】我的 Discord Bot 進化史：從鸚鵡學舌到 Agentic AI 的奇幻漂流 | 哈爸筆記</title><meta name=keywords content="n8n,Discord Bot,Agentic AI,Gemini,LangChain"><meta name=description content="這篇文章紀錄了我的 Discord Bot 成長三部曲：從最基礎的 Echo Bot，到接上 Google Gemini 大腦，最後透過 n8n 的 Agent 節點賦予它使用工具 (計算機、維基百科) 的能力，真正實現 Agentic AI。"><meta name=author content="Wuulong"><link rel=canonical href=http://localhost:1313/wuulong-notes-blog/posts/20251217_building-agentic-discord-bot/><link crossorigin=anonymous href=/wuulong-notes-blog/assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css integrity="sha256-NDzEgLn/yPBMy+XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/wuulong-notes-blog/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/wuulong-notes-blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/wuulong-notes-blog/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/wuulong-notes-blog/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/wuulong-notes-blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/wuulong-notes-blog/posts/20251217_building-agentic-discord-bot/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="http://localhost:1313/wuulong-notes-blog/posts/20251217_building-agentic-discord-bot/"><meta property="og:site_name" content="哈爸筆記"><meta property="og:title" content="【實戰】我的 Discord Bot 進化史：從鸚鵡學舌到 Agentic AI 的奇幻漂流"><meta property="og:description" content="這篇文章紀錄了我的 Discord Bot 成長三部曲：從最基礎的 Echo Bot，到接上 Google Gemini 大腦，最後透過 n8n 的 Agent 節點賦予它使用工具 (計算機、維基百科) 的能力，真正實現 Agentic AI。"><meta property="og:locale" content="zh-tw"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-12-17T15:30:00+08:00"><meta property="article:modified_time" content="2025-12-17T15:30:00+08:00"><meta property="article:tag" content="N8n"><meta property="article:tag" content="Discord Bot"><meta property="article:tag" content="Agentic AI"><meta property="article:tag" content="Gemini"><meta property="article:tag" content="LangChain"><meta property="og:image" content="http://localhost:1313/wuulong-notes-blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="og:see_also" content="http://localhost:1313/wuulong-notes-blog/posts/20251218_n8n-drive-rag/"><meta property="og:see_also" content="http://localhost:1313/wuulong-notes-blog/posts/20251218_discord-welcome-bot/"><meta property="og:see_also" content="http://localhost:1313/wuulong-notes-blog/posts/20251217_n8n-discord-bot-troubleshooting/"><meta property="og:see_also" content="http://localhost:1313/wuulong-notes-blog/posts/20251217_zeabur-n8n-deployment/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/wuulong-notes-blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="【實戰】我的 Discord Bot 進化史：從鸚鵡學舌到 Agentic AI 的奇幻漂流"><meta name=twitter:description content="這篇文章紀錄了我的 Discord Bot 成長三部曲：從最基礎的 Echo Bot，到接上 Google Gemini 大腦，最後透過 n8n 的 Agent 節點賦予它使用工具 (計算機、維基百科) 的能力，真正實現 Agentic AI。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/wuulong-notes-blog/posts/"},{"@type":"ListItem","position":2,"name":"【實戰】我的 Discord Bot 進化史：從鸚鵡學舌到 Agentic AI 的奇幻漂流","item":"http://localhost:1313/wuulong-notes-blog/posts/20251217_building-agentic-discord-bot/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"【實戰】我的 Discord Bot 進化史：從鸚鵡學舌到 Agentic AI 的奇幻漂流","name":"【實戰】我的 Discord Bot 進化史：從鸚鵡學舌到 Agentic AI 的奇幻漂流","description":"這篇文章紀錄了我的 Discord Bot 成長三部曲：從最基礎的 Echo Bot，到接上 Google Gemini 大腦，最後透過 n8n 的 Agent 節點賦予它使用工具 (計算機、維基百科) 的能力，真正實現 Agentic AI。","keywords":["n8n","Discord Bot","Agentic AI","Gemini","LangChain"],"articleBody":"接續上一篇 【踩坑筆記】用 n8n 打造 Discord Bot，在經歷了無數次 “Token 錯誤” 和 “Intent 沒開” 的崩潰後，我的機器人終於會說話了。\n但只會 “Echo” (我說什麼它回什麼) 的機器人實在太無聊。既然都已經在 n8n 上了，何不直上雲端，幫它接個最強的大腦？\n這篇文章紀錄了我將它從「鸚鵡」進化成「智慧助理 (Agent)」的過程。\n第一階段：接上大腦 (LLM Integration) 一開始的想法很簡單：把 Discord 收到的訊息，丟給 Google Gemini，再把 Gemini 的回覆丟回 Discord。\n在 n8n 裡，這只需要替換中間的節點：\n移除：原本直接把 Input 接到 Output 的線。 加入：Google Gemini Chat Model 節點。 就這樣，我的機器人瞬間變成了一個無所不知的 Chatbot。您可以問它 “Python 怎麼學？” 或 “幫我寫首詩”，它都能對答如流。\n但這時候的它，還有兩個致命弱點：\n沒有記憶：每一句話對它來說都是新的，它不知道我上一句罵過它。 會亂掰 (Hallucination)：問它複雜的數學或最新的新聞，它會一本正經地胡說八道。 第二階段：賦予手腳 (Agentic AI) 為了解決上述問題，我接觸到了 Agentic AI 的概念。 簡單來說，就是不再讓 LLM「憑空想像」，而是給它一組 工具 (Tools)，讓它自己決定何時該用工具來找答案。\n在 n8n 裡，這透過 AI Agent 節點來實現。這是我目前的架構圖：\n(在此處想像一張完美的 n8n 節點連接圖)\n架構解析 這個架構由四個核心部分組成，就像一個完整的人腦運作機制：\n中樞指揮官 (AI Agent 節點)： 這是整個流程的大腦。它接收使用者的問題，進行 推理 (Reasoning)。\n「用戶問天氣？那我應該去查天氣工具。」 「用戶問數學？那我應該用計算機。」 大腦模型 (Model)： 我掛載了 Google Gemini Chat Model。它負責理解語意和生成最終的自然語言回覆。\n短期記憶 (Memory)： 我接上了 Window Buffer Memory。這讓機器人擁有了「短期記憶」，能記得我們前幾句的對話內容，聊天不再像鬼打牆。\n雙手工具 (Tools)： 這是 Agentic AI 的靈魂。我給了它兩個法寶：\nCalculator (計算機)：專門處理數學運算，解決 LLM 算數不準的問題。 Wikipedia (維基百科)：即使是免費版，也能讓它查詢模型訓練資料以外的知識。 實際體驗：它真的在「思考」 當我問它：「請問 35436 乘以 1234 等於多少？還有 Python 是哪一年發布的？」\n如果是以前的 Chatbot，它可能會直接猜一個數字。 但現在，看著 n8n 的執行 Log，你會看到 Agent 忙碌的過程：\nAgent 思考：「這句有數學題，我應該呼叫 Calculator。」-\u003e 執行計算。 Agent 思考：「還有歷史題，我應該呼叫 Wikipedia 查 “Python programming language”。」-\u003e 閱讀維基百科。 Agent 總結：「結合計算結果 43,728,024 和維基百科的 1991 年…」-\u003e 生成回覆。 這就是 Agentic AI 的魅力。它不再是單純的文字接龍，而是真正具有 「解決問題能力」 的智慧體。\n第三階段：打造法律專家 (SQL Tool Integration) 現在它已經會算數、會查維基了。但我的終極目標是讓它能查詢我自己建立的 Postgres 法律資料庫。\n這一步是最具挑戰性，也最迷人的地方。我並沒有寫死什麼「關鍵字查詢」功能，而是做了一個 「通用 SQL 執行器」，並透過 Prompt Engineering 讓 AI 自己學會寫 SQL。\n(圖：接上了 Postgres 資料庫的 Agentic Workflow 完整架構)\n關鍵設定解析 要達成這個效果，不再是靠程式碼，而是靠「溝通」。設定上只有這兩個重點：\n1. 工具端 (The Hand)：只負責執行 我建立了一個 Sub-Workflow，它的邏輯非常暴力簡單：\nInput: 接收一個字串參數，我們把它定義為 sql_str。 Action: 把這個字串原封不動地丟給 Postgres 節點去執行 (Execute Query)。 Output: 回傳 SQL 執行的結果。 它就像一隻手，完全不管內容，給什麼執行什麼。\n2. Agent 端 (The Brain)：教它資料結構 這才是真正的魔法所在。 在主流程的 Call Workflow Tool 節點中，我在 Description 欄位寫了一大段「說明書」。\n這段說明書不只是說「這是查資料庫用的」，更重要的是把資料庫的 Schema 全部告訴它！\n我的 Description 大概是這樣寫的：\n“Help the user query their PostgreSQL database by executing SQL queries. This database named ’lawdb’ includes a table named ‘articles’ with columns ‘id’, ‘content’, ‘chapter’…”\n(圖：關鍵的設定細節。注意 Description 欄位裡，我把 Table Schema 都塞進去了，這樣 Gemini 才知道怎麼寫 SQL)\n成果：Text-to-SQL 當我問它：「政府採購法總共有幾條？」\nGemini 的思考過程是這樣的：\n理解問題：用戶想算數量 (Count)。 查詢記憶：看過 Tool Description，知道有一個 articles 表。 生成 SQL：它自己寫出了 SELECT COUNT(*) FROM articles WHERE ...。 呼叫工具：把這段 SQL 丟給我的 Sub-Workflow。 回答：「總共有 123 條。」 這就是 Agentic AI 強大的地方。我不需要為每一個查詢需求寫程式，我只需要把「資料結構」教給它，剩下的 SQL，它自己會寫！\nAI 協作宣告 (AI Collaboration Disclosure) 本文內容由 AI 協作生成：\n素材來源：作者 n8n 實作截圖與學習筆記。 AI 工具：使用 Antigravity (Gemini) 協助整理 Agentic AI 概念與文章撰寫。 人工審核：由哈爸本人確認技術細節準確性並進行最終潤飾。 ","wordCount":"300","inLanguage":"en","image":"http://localhost:1313/wuulong-notes-blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2025-12-17T15:30:00+08:00","dateModified":"2025-12-17T15:30:00+08:00","author":{"@type":"Person","name":"Wuulong"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/wuulong-notes-blog/posts/20251217_building-agentic-discord-bot/"},"publisher":{"@type":"Organization","name":"哈爸筆記","logo":{"@type":"ImageObject","url":"http://localhost:1313/wuulong-notes-blog/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/wuulong-notes-blog/ accesskey=h title="哈爸筆記 (Alt + H)">哈爸筆記</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/wuulong-notes-blog/categories/ title=categories><span>categories</span></a></li><li><a href=http://localhost:1313/wuulong-notes-blog/series/ title=Series><span>Series</span></a></li><li><a href=http://localhost:1313/wuulong-notes-blog/planning/ title=Planning><span>Planning</span></a></li><li><a href=http://localhost:1313/wuulong-notes-blog/tags/ title=tags><span>tags</span></a></li><li><a href=http://localhost:1313/wuulong-notes-blog/posts/ title=Posts><span>Posts</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/wuulong-notes-blog/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/wuulong-notes-blog/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">【實戰】我的 Discord Bot 進化史：從鸚鵡學舌到 Agentic AI 的奇幻漂流</h1><div class=post-description>這篇文章紀錄了我的 Discord Bot 成長三部曲：從最基礎的 Echo Bot，到接上 Google Gemini 大腦，最後透過 n8n 的 Agent 節點賦予它使用工具 (計算機、維基百科) 的能力，真正實現 Agentic AI。</div><div class=post-meta><span title='2025-12-17 15:30:00 +0800 CST'>2025-12-17</span>&nbsp;·&nbsp;<span>2 min</span>&nbsp;·&nbsp;<span>300 words</span>&nbsp;·&nbsp;<span>Wuulong</span></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e7%ac%ac%e4%b8%80%e9%9a%8e%e6%ae%b5%e6%8e%a5%e4%b8%8a%e5%a4%a7%e8%85%a6-llm-integration aria-label="第一階段：接上大腦 (LLM Integration)">第一階段：接上大腦 (LLM Integration)</a></li><li><a href=#%e7%ac%ac%e4%ba%8c%e9%9a%8e%e6%ae%b5%e8%b3%a6%e4%ba%88%e6%89%8b%e8%85%b3-agentic-ai aria-label="第二階段：賦予手腳 (Agentic AI)">第二階段：賦予手腳 (Agentic AI)</a><ul><li><a href=#%e6%9e%b6%e6%a7%8b%e8%a7%a3%e6%9e%90 aria-label=架構解析>架構解析</a></li></ul></li><li><a href=#%e5%af%a6%e9%9a%9b%e9%ab%94%e9%a9%97%e5%ae%83%e7%9c%9f%e7%9a%84%e5%9c%a8%e6%80%9d%e8%80%83 aria-label=實際體驗：它真的在「思考」>實際體驗：它真的在「思考」</a></li><li><a href=#%e7%ac%ac%e4%b8%89%e9%9a%8e%e6%ae%b5%e6%89%93%e9%80%a0%e6%b3%95%e5%be%8b%e5%b0%88%e5%ae%b6-sql-tool-integration aria-label="第三階段：打造法律專家 (SQL Tool Integration)">第三階段：打造法律專家 (SQL Tool Integration)</a><ul><li><a href=#%e9%97%9c%e9%8d%b5%e8%a8%ad%e5%ae%9a%e8%a7%a3%e6%9e%90 aria-label=關鍵設定解析>關鍵設定解析</a><ul><li><a href=#1-%e5%b7%a5%e5%85%b7%e7%ab%af-the-hand%e5%8f%aa%e8%b2%a0%e8%b2%ac%e5%9f%b7%e8%a1%8c aria-label="1. 工具端 (The Hand)：只負責執行">1. 工具端 (The Hand)：只負責執行</a></li><li><a href=#2-agent-%e7%ab%af-the-brain%e6%95%99%e5%ae%83%e8%b3%87%e6%96%99%e7%b5%90%e6%a7%8b aria-label="2. Agent 端 (The Brain)：教它資料結構">2. Agent 端 (The Brain)：教它資料結構</a></li></ul></li><li><a href=#%e6%88%90%e6%9e%9ctext-to-sql aria-label=成果：Text-to-SQL>成果：Text-to-SQL</a></li><li><a href=#ai-%e5%8d%94%e4%bd%9c%e5%ae%a3%e5%91%8a-ai-collaboration-disclosure aria-label="AI 協作宣告 (AI Collaboration Disclosure)">AI 協作宣告 (AI Collaboration Disclosure)</a></li></ul></li></ul></div></details></div><div class=post-content><p>接續上一篇 <strong><a href=/posts/20251217_n8n-discord-bot-troubleshooting/>【踩坑筆記】用 n8n 打造 Discord Bot</a></strong>，在經歷了無數次 &ldquo;Token 錯誤&rdquo; 和 &ldquo;Intent 沒開&rdquo; 的崩潰後，我的機器人終於會說話了。</p><p>但只會 &ldquo;Echo&rdquo; (我說什麼它回什麼) 的機器人實在太無聊。既然都已經在 n8n 上了，何不直上雲端，幫它接個最強的大腦？</p><p>這篇文章紀錄了我將它從「鸚鵡」進化成「智慧助理 (Agent)」的過程。</p><h2 id=第一階段接上大腦-llm-integration>第一階段：接上大腦 (LLM Integration)<a hidden class=anchor aria-hidden=true href=#第一階段接上大腦-llm-integration>#</a></h2><p>一開始的想法很簡單：把 Discord 收到的訊息，丟給 Google Gemini，再把 Gemini 的回覆丟回 Discord。</p><p>在 n8n 裡，這只需要替換中間的節點：</p><ul><li><strong>移除</strong>：原本直接把 Input 接到 Output 的線。</li><li><strong>加入</strong>：<code>Google Gemini Chat Model</code> 節點。</li></ul><p>就這樣，我的機器人瞬間變成了一個無所不知的 Chatbot。您可以問它 &ldquo;Python 怎麼學？&rdquo; 或 &ldquo;幫我寫首詩&rdquo;，它都能對答如流。</p><p>但這時候的它，還有兩個致命弱點：</p><ol><li><strong>沒有記憶</strong>：每一句話對它來說都是新的，它不知道我上一句罵過它。</li><li><strong>會亂掰 (Hallucination)</strong>：問它複雜的數學或最新的新聞，它會一本正經地胡說八道。</li></ol><h2 id=第二階段賦予手腳-agentic-ai>第二階段：賦予手腳 (Agentic AI)<a hidden class=anchor aria-hidden=true href=#第二階段賦予手腳-agentic-ai>#</a></h2><p>為了解決上述問題，我接觸到了 <strong>Agentic AI</strong> 的概念。
簡單來說，就是不再讓 LLM「憑空想像」，而是給它一組 <strong>工具 (Tools)</strong>，讓它自己決定何時該用工具來找答案。</p><p>在 n8n 裡，這透過 <strong><code>AI Agent</code></strong> 節點來實現。這是我目前的架構圖：</p><p><img alt=n8n_agentic_discord loading=lazy src=/wuulong-notes-blog/posts/20251217_building-agentic-discord-bot/n8n_agentic_discord.png>
<em>(在此處想像一張完美的 n8n 節點連接圖)</em></p><h3 id=架構解析>架構解析<a hidden class=anchor aria-hidden=true href=#架構解析>#</a></h3><p>這個架構由四個核心部分組成，就像一個完整的人腦運作機制：</p><ol><li><p><strong>中樞指揮官 (AI Agent 節點)</strong>：
這是整個流程的大腦。它接收使用者的問題，進行 <strong>推理 (Reasoning)</strong>。</p><ul><li><em>「用戶問天氣？那我應該去查天氣工具。」</em></li><li><em>「用戶問數學？那我應該用計算機。」</em></li></ul></li><li><p><strong>大腦模型 (Model)</strong>：
我掛載了 <strong>Google Gemini Chat Model</strong>。它負責理解語意和生成最終的自然語言回覆。</p></li><li><p><strong>短期記憶 (Memory)</strong>：
我接上了 <strong>Window Buffer Memory</strong>。這讓機器人擁有了「短期記憶」，能記得我們前幾句的對話內容，聊天不再像鬼打牆。</p></li><li><p><strong>雙手工具 (Tools)</strong>：
這是 Agentic AI 的靈魂。我給了它兩個法寶：</p><ul><li><strong>Calculator (計算機)</strong>：專門處理數學運算，解決 LLM 算數不準的問題。</li><li><strong>Wikipedia (維基百科)</strong>：即使是免費版，也能讓它查詢模型訓練資料以外的知識。</li></ul></li></ol><h2 id=實際體驗它真的在思考>實際體驗：它真的在「思考」<a hidden class=anchor aria-hidden=true href=#實際體驗它真的在思考>#</a></h2><p>當我問它：「請問 35436 乘以 1234 等於多少？還有 Python 是哪一年發布的？」</p><p>如果是以前的 Chatbot，它可能會直接猜一個數字。
但現在，看著 n8n 的執行 Log，你會看到 Agent 忙碌的過程：</p><ol><li><em>Agent 思考</em>：「這句有數學題，我應該呼叫 <strong>Calculator</strong>。」-> <strong>執行計算</strong>。</li><li><em>Agent 思考</em>：「還有歷史題，我應該呼叫 <strong>Wikipedia</strong> 查 &ldquo;Python programming language&rdquo;。」-> <strong>閱讀維基百科</strong>。</li><li><em>Agent 總結</em>：「結合計算結果 43,728,024 和維基百科的 1991 年&mldr;」-> <strong>生成回覆</strong>。</li></ol><p>這就是 Agentic AI 的魅力。它不再是單純的文字接龍，而是真正具有 <strong>「解決問題能力」</strong> 的智慧體。</p><h2 id=第三階段打造法律專家-sql-tool-integration>第三階段：打造法律專家 (SQL Tool Integration)<a hidden class=anchor aria-hidden=true href=#第三階段打造法律專家-sql-tool-integration>#</a></h2><p>現在它已經會算數、會查維基了。但我的終極目標是讓它能查詢我自己建立的 <strong>Postgres 法律資料庫</strong>。</p><p>這一步是最具挑戰性，也最迷人的地方。我並沒有寫死什麼「關鍵字查詢」功能，而是做了一個 <strong>「通用 SQL 執行器」</strong>，並透過 Prompt Engineering 讓 AI 自己學會寫 SQL。</p><p><img alt=UsingDBOK loading=lazy src=/wuulong-notes-blog/posts/20251217_building-agentic-discord-bot/UsingDBOK.png>
<em>(圖：接上了 Postgres 資料庫的 Agentic Workflow 完整架構)</em></p><h3 id=關鍵設定解析>關鍵設定解析<a hidden class=anchor aria-hidden=true href=#關鍵設定解析>#</a></h3><p>要達成這個效果，不再是靠程式碼，而是靠「溝通」。設定上只有這兩個重點：</p><h4 id=1-工具端-the-hand只負責執行>1. 工具端 (The Hand)：只負責執行<a hidden class=anchor aria-hidden=true href=#1-工具端-the-hand只負責執行>#</a></h4><p>我建立了一個 Sub-Workflow，它的邏輯非常暴力簡單：</p><ul><li><strong>Input</strong>: 接收一個字串參數，我們把它定義為 <code>sql_str</code>。</li><li><strong>Action</strong>: 把這個字串原封不動地丟給 Postgres 節點去執行 (Execute Query)。</li><li><strong>Output</strong>: 回傳 SQL 執行的結果。</li></ul><p>它就像一隻手，完全不管內容，給什麼執行什麼。</p><h4 id=2-agent-端-the-brain教它資料結構>2. Agent 端 (The Brain)：教它資料結構<a hidden class=anchor aria-hidden=true href=#2-agent-端-the-brain教它資料結構>#</a></h4><p>這才是真正的魔法所在。
在主流程的 <strong>Call Workflow Tool</strong> 節點中，我在 <strong>Description</strong> 欄位寫了一大段「說明書」。</p><p>這段說明書不只是說「這是查資料庫用的」，更重要的是<strong>把資料庫的 Schema 全部告訴它</strong>！</p><p>我的 Description 大概是這樣寫的：</p><blockquote><p>&ldquo;Help the user query their PostgreSQL database by executing SQL queries. This database named &rsquo;lawdb&rsquo; includes a table named <strong>&lsquo;articles&rsquo;</strong> with columns <strong>&lsquo;id&rsquo;, &lsquo;content&rsquo;, &lsquo;chapter&rsquo;</strong>&mldr;&rdquo;</p></blockquote><p><img alt=UsingDBLog loading=lazy src=/wuulong-notes-blog/posts/20251217_building-agentic-discord-bot/UsingDBLog.png>
<em>(圖：關鍵的設定細節。注意 Description 欄位裡，我把 Table Schema 都塞進去了，這樣 Gemini 才知道怎麼寫 SQL)</em></p><h3 id=成果text-to-sql>成果：Text-to-SQL<a hidden class=anchor aria-hidden=true href=#成果text-to-sql>#</a></h3><p>當我問它：「政府採購法總共有幾條？」</p><p>Gemini 的思考過程是這樣的：</p><ol><li><strong>理解問題</strong>：用戶想算數量 (Count)。</li><li><strong>查詢記憶</strong>：看過 Tool Description，知道有一個 <code>articles</code> 表。</li><li><strong>生成 SQL</strong>：它自己寫出了 <code>SELECT COUNT(*) FROM articles WHERE ...</code>。</li><li><strong>呼叫工具</strong>：把這段 SQL 丟給我的 Sub-Workflow。</li><li><strong>回答</strong>：「總共有 123 條。」</li></ol><p>這就是 <strong>Agentic AI</strong> 強大的地方。我不需要為每一個查詢需求寫程式，我只需要把「資料結構」教給它，剩下的 SQL，它自己會寫！</p><h3 id=ai-協作宣告-ai-collaboration-disclosure>AI 協作宣告 (AI Collaboration Disclosure)<a hidden class=anchor aria-hidden=true href=#ai-協作宣告-ai-collaboration-disclosure>#</a></h3><blockquote><p><img alt="AI Generated" loading=lazy src="https://img.shields.io/badge/Content-AI%20Assisted-8A2BE2?style=flat-square&logo=google-gemini&logoColor=white">
<img alt="Human Reviewed" loading=lazy src="https://img.shields.io/badge/Review-Human%20Verified-green?style=flat-square"></p><p><strong>本文內容由 AI 協作生成</strong>：</p><ol><li><strong>素材來源</strong>：作者 n8n 實作截圖與學習筆記。</li><li><strong>AI 工具</strong>：使用 Antigravity (Gemini) 協助整理 Agentic AI 概念與文章撰寫。</li><li><strong>人工審核</strong>：由哈爸本人確認技術細節準確性並進行最終潤飾。</li></ol></blockquote></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/wuulong-notes-blog/tags/n8n/>N8n</a></li><li><a href=http://localhost:1313/wuulong-notes-blog/tags/discord-bot/>Discord Bot</a></li><li><a href=http://localhost:1313/wuulong-notes-blog/tags/agentic-ai/>Agentic AI</a></li><li><a href=http://localhost:1313/wuulong-notes-blog/tags/gemini/>Gemini</a></li><li><a href=http://localhost:1313/wuulong-notes-blog/tags/langchain/>LangChain</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/wuulong-notes-blog/posts/20251217_dme-50th-planning-meeting/><span class=title>« Prev</span><br><span>【系慶快報】交大機械系 50 週年特展籌備啟動！邀您共襄盛舉</span>
</a><a class=next href=http://localhost:1313/wuulong-notes-blog/posts/20251217_n8n-discord-bot-troubleshooting/><span class=title>Next »</span><br><span>【踩坑筆記】用 n8n 打造 Discord Bot：那些官方文件沒說的「隱形牆」</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share 【實戰】我的 Discord Bot 進化史：從鸚鵡學舌到 Agentic AI 的奇幻漂流 on x" href="https://x.com/intent/tweet/?text=%e3%80%90%e5%af%a6%e6%88%b0%e3%80%91%e6%88%91%e7%9a%84%20Discord%20Bot%20%e9%80%b2%e5%8c%96%e5%8f%b2%ef%bc%9a%e5%be%9e%e9%b8%9a%e9%b5%a1%e5%ad%b8%e8%88%8c%e5%88%b0%20Agentic%20AI%20%e7%9a%84%e5%a5%87%e5%b9%bb%e6%bc%82%e6%b5%81&amp;url=http%3a%2f%2flocalhost%3a1313%2fwuulong-notes-blog%2fposts%2f20251217_building-agentic-discord-bot%2f&amp;hashtags=n8n%2cDiscordBot%2cAgenticAI%2cGemini%2cLangChain"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 【實戰】我的 Discord Bot 進化史：從鸚鵡學舌到 Agentic AI 的奇幻漂流 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fwuulong-notes-blog%2fposts%2f20251217_building-agentic-discord-bot%2f&amp;title=%e3%80%90%e5%af%a6%e6%88%b0%e3%80%91%e6%88%91%e7%9a%84%20Discord%20Bot%20%e9%80%b2%e5%8c%96%e5%8f%b2%ef%bc%9a%e5%be%9e%e9%b8%9a%e9%b5%a1%e5%ad%b8%e8%88%8c%e5%88%b0%20Agentic%20AI%20%e7%9a%84%e5%a5%87%e5%b9%bb%e6%bc%82%e6%b5%81&amp;summary=%e3%80%90%e5%af%a6%e6%88%b0%e3%80%91%e6%88%91%e7%9a%84%20Discord%20Bot%20%e9%80%b2%e5%8c%96%e5%8f%b2%ef%bc%9a%e5%be%9e%e9%b8%9a%e9%b5%a1%e5%ad%b8%e8%88%8c%e5%88%b0%20Agentic%20AI%20%e7%9a%84%e5%a5%87%e5%b9%bb%e6%bc%82%e6%b5%81&amp;source=http%3a%2f%2flocalhost%3a1313%2fwuulong-notes-blog%2fposts%2f20251217_building-agentic-discord-bot%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 【實戰】我的 Discord Bot 進化史：從鸚鵡學舌到 Agentic AI 的奇幻漂流 on reddit" href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fwuulong-notes-blog%2fposts%2f20251217_building-agentic-discord-bot%2f&title=%e3%80%90%e5%af%a6%e6%88%b0%e3%80%91%e6%88%91%e7%9a%84%20Discord%20Bot%20%e9%80%b2%e5%8c%96%e5%8f%b2%ef%bc%9a%e5%be%9e%e9%b8%9a%e9%b5%a1%e5%ad%b8%e8%88%8c%e5%88%b0%20Agentic%20AI%20%e7%9a%84%e5%a5%87%e5%b9%bb%e6%bc%82%e6%b5%81"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 【實戰】我的 Discord Bot 進化史：從鸚鵡學舌到 Agentic AI 的奇幻漂流 on facebook" href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fwuulong-notes-blog%2fposts%2f20251217_building-agentic-discord-bot%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 【實戰】我的 Discord Bot 進化史：從鸚鵡學舌到 Agentic AI 的奇幻漂流 on whatsapp" href="https://api.whatsapp.com/send?text=%e3%80%90%e5%af%a6%e6%88%b0%e3%80%91%e6%88%91%e7%9a%84%20Discord%20Bot%20%e9%80%b2%e5%8c%96%e5%8f%b2%ef%bc%9a%e5%be%9e%e9%b8%9a%e9%b5%a1%e5%ad%b8%e8%88%8c%e5%88%b0%20Agentic%20AI%20%e7%9a%84%e5%a5%87%e5%b9%bb%e6%bc%82%e6%b5%81%20-%20http%3a%2f%2flocalhost%3a1313%2fwuulong-notes-blog%2fposts%2f20251217_building-agentic-discord-bot%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 【實戰】我的 Discord Bot 進化史：從鸚鵡學舌到 Agentic AI 的奇幻漂流 on telegram" href="https://telegram.me/share/url?text=%e3%80%90%e5%af%a6%e6%88%b0%e3%80%91%e6%88%91%e7%9a%84%20Discord%20Bot%20%e9%80%b2%e5%8c%96%e5%8f%b2%ef%bc%9a%e5%be%9e%e9%b8%9a%e9%b5%a1%e5%ad%b8%e8%88%8c%e5%88%b0%20Agentic%20AI%20%e7%9a%84%e5%a5%87%e5%b9%bb%e6%bc%82%e6%b5%81&amp;url=http%3a%2f%2flocalhost%3a1313%2fwuulong-notes-blog%2fposts%2f20251217_building-agentic-discord-bot%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 【實戰】我的 Discord Bot 進化史：從鸚鵡學舌到 Agentic AI 的奇幻漂流 on ycombinator" href="https://news.ycombinator.com/submitlink?t=%e3%80%90%e5%af%a6%e6%88%b0%e3%80%91%e6%88%91%e7%9a%84%20Discord%20Bot%20%e9%80%b2%e5%8c%96%e5%8f%b2%ef%bc%9a%e5%be%9e%e9%b8%9a%e9%b5%a1%e5%ad%b8%e8%88%8c%e5%88%b0%20Agentic%20AI%20%e7%9a%84%e5%a5%87%e5%b9%bb%e6%bc%82%e6%b5%81&u=http%3a%2f%2flocalhost%3a1313%2fwuulong-notes-blog%2fposts%2f20251217_building-agentic-discord-bot%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/wuulong-notes-blog/>哈爸筆記</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script></body></html>